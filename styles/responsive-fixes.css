/* ========================================
   RESPONSIVE FIXES FOR VARIOUS SCREEN SIZES
   ======================================== */

/* Hide scrollbars on mobile app */
body, html {
  -ms-overflow-style: none; /* IE and Edge */
  scrollbar-width: none; /* Firefox */
}

body::-webkit-scrollbar,
html::-webkit-scrollbar,
*::-webkit-scrollbar {
  display: none; /* Chrome, Safari, Opera */
}

/* Handle extremely tall screens (like Pixel 7a: 1080x2400) */
@media screen and (max-width: 480px) and (min-height: 800px) {
  /* Fix for very tall, narrow screens */
  .mobile-container {
    min-height: 100vh !important;
    max-height: 100vh !important;
    overflow-y: auto !important;
  }
  
  /* Better spacing for tall screens */
  .mobile-page {
    padding: 1rem !important;
    gap: 1rem !important;
  }
  
  /* Fix button sizing on narrow screens */
  .mobile-button {
    min-height: 48px !important;
    padding: 12px 16px !important;
    font-size: 16px !important;
    touch-action: manipulation !important;
  }
  
  /* Ensure forms don't overflow */
  .mobile-form {
    width: 100% !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
  }
  
  .mobile-form-field {
    width: 100% !important;
    margin-bottom: 1rem !important;
  }
  
  /* Fix input fields for mobile */
  .mobile-input {
    width: 100% !important;
    min-height: 48px !important;
    font-size: 16px !important; /* Prevents zoom on iOS */
    padding: 12px 16px !important;
    box-sizing: border-box !important;
  }
  
  /* Navigation fixes for tall screens */
  .mobile-nav {
    position: sticky !important;
    top: 0 !important;
    z-index: 1000 !important;
    background: white !important;
  }
  
  /* Content area adjustments */
  .mobile-content {
    flex: 1 !important;
    overflow-y: auto !important;
    padding: 1rem !important;
    min-height: 0 !important;
  }
}

/* Handle very wide screens (landscape on tablets) */
@media screen and (min-width: 768px) and (max-height: 500px) {
  .mobile-layout {
    flex-direction: row !important;
  }
  
  .mobile-sidebar {
    width: 300px !important;
    height: 100vh !important;
  }
  
  .mobile-main {
    flex: 1 !important;
    height: 100vh !important;
    overflow-y: auto !important;
  }
}

/* Safe area handling for notched devices */
@supports (padding: max(0px)) {
  .mobile-safe-area {
    padding-top: max(1rem, env(safe-area-inset-top)) !important;
    padding-bottom: max(1rem, env(safe-area-inset-bottom)) !important;
    padding-left: max(1rem, env(safe-area-inset-left)) !important;
    padding-right: max(1rem, env(safe-area-inset-right)) !important;
  }
}

/* Touch target improvements */
@media (hover: none) and (pointer: coarse) {
  /* This targets touch devices */
  button, .clickable, [role="button"] {
    min-height: 48px !important;
    min-width: 48px !important;
    touch-action: manipulation !important;
  }
  
  /* Better spacing for touch targets */
  .mobile-menu-item {
    padding: 16px !important;
    margin: 4px 0 !important;
  }
  
  /* Improve scrolling on touch devices */
  .scrollable {
    -webkit-overflow-scrolling: touch !important;
    overflow-y: auto !important;
  }
}

/* Fix viewport height issues on mobile browsers */
.full-height {
  height: 100vh !important;
  height: 100dvh !important; /* Dynamic viewport height */
}

/* Container query fallbacks for older browsers */
.responsive-container {
  width: 100% !important;
  max-width: 100% !important;
  overflow-x: hidden !important;
  box-sizing: border-box !important;
}

/* Grid system that adapts to screen size */
.responsive-grid {
  display: grid !important;
  gap: 1rem !important;
  grid-template-columns: 1fr !important;
}

@media (min-width: 640px) {
  .responsive-grid {
    grid-template-columns: repeat(2, 1fr) !important;
  }
}

@media (min-width: 1024px) {
  .responsive-grid {
    grid-template-columns: repeat(3, 1fr) !important;
  }
}

/* Text scaling for different screen densities */
@media (-webkit-min-device-pixel-ratio: 2) {
  .mobile-text {
    font-size: 16px !important;
    line-height: 1.5 !important;
  }
}

@media (-webkit-min-device-pixel-ratio: 3) {
  .mobile-text {
    font-size: 17px !important;
    line-height: 1.6 !important;
  }
}

/* Fix for Android Chrome address bar height changes */
@media screen and (max-width: 768px) {
  .mobile-viewport-fix {
    height: 100vh !important;
    height: calc(var(--vh, 1vh) * 100) !important;
  }
}

/* Ensure QR codes and images scale properly */
.responsive-image {
  width: 100% !important;
  max-width: 300px !important;
  height: auto !important;
  margin: 0 auto !important;
  display: block !important;
}

/* Modal and overlay fixes for mobile */
.mobile-modal {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  width: 100% !important;
  height: 100% !important;
  z-index: 9999 !important;
  overflow-y: auto !important;
}

.mobile-modal-content {
  min-height: 100vh !important;
  padding: 2rem 1rem !important;
  box-sizing: border-box !important;
}

/* Fix for form validation messages */
.mobile-error-message {
  font-size: 14px !important;
  margin-top: 0.5rem !important;
  word-wrap: break-word !important;
  max-width: 100% !important;
}

/* Prevent horizontal scroll caused by wide elements */
* {
  max-width: 100% !important;
}

/* But allow some exceptions for specific elements */
.allow-wide,
.code-block,
.table-container {
  max-width: none !important;
}

/* Keyboard open state adjustments */
body.keyboard-open {
  height: auto !important;
  max-height: 100vh !important;
}

body.keyboard-open .mobile-viewport-fix {
  height: auto !important;
  max-height: 100vh !important;
}

/* Tap active state */
.tap-active {
  opacity: 0.7 !important;
  transform: scale(0.98) !important;
  transition: all 0.1s ease !important;
}

/* Orientation-specific styles */
body.portrait .mobile-layout {
  flex-direction: column !important;
}

body.landscape .mobile-layout {
  flex-direction: row !important;
}

/* Capacitor app specific styles */
body.capacitor-app {
  /* Native app specific adjustments */
  -webkit-user-select: none !important;
  user-select: none !important;
  -webkit-tap-highlight-color: transparent !important;
}

/* Enhanced mobile styles */
body.mobile-enhanced {
  /* Apply all mobile enhancements */
  touch-action: manipulation !important;
  -webkit-touch-callout: none !important;
  -webkit-user-select: none !important;
  user-select: none !important;
}

/* Allow text selection in specific areas */
body.mobile-enhanced input,
body.mobile-enhanced textarea,
body.mobile-enhanced .selectable-text {
  -webkit-user-select: text !important;
  user-select: text !important;
}