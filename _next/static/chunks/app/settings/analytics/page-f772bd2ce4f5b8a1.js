(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5257],{20063:(e,t,a)=>{"use strict";var i=a(47260);a.o(i,"usePathname")&&a.d(t,{usePathname:function(){return i.usePathname}}),a.o(i,"useRouter")&&a.d(t,{useRouter:function(){return i.useRouter}}),a.o(i,"useSearchParams")&&a.d(t,{useSearchParams:function(){return i.useSearchParams}}),a.o(i,"useServerInsertedHTML")&&a.d(t,{useServerInsertedHTML:function(){return i.useServerInsertedHTML}})},35626:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});let i=(0,a(71847).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},40294:(e,t,a)=>{"use strict";a.d(t,{kt:()=>u,lV:()=>h,p8:()=>p});var i=a(95155);a(12115);var n=a(50625);let r=(0,n.i7)(["from{transform:rotate(0deg);}to{transform:rotate(360deg);}"]),s=n.Ay.div.withConfig({componentId:"jt-app__sc-50765fb0-0"})(["animation:"," 1s linear infinite;"," ",""],r,e=>{let{$size:t}=e;switch(t){case"sm":return"width: 1rem; height: 1rem;";case"lg":return"width: 2rem; height: 2rem;";default:return"width: 1.5rem; height: 1.5rem;"}},e=>{let{$color:t,theme:a}=e;switch(t){case"white":return"color: white;";case"gray":return"color: ".concat(a.colors.secondary[600],";");default:return"color: ".concat(a.colors.primary[600],";")}}),o=n.Ay.button.withConfig({componentId:"jt-app__sc-50765fb0-1"})(["display:flex;align-items:center;justify-content:center;gap:0.5rem;&:disabled{opacity:0.5;cursor:not-allowed;}"]),l=n.Ay.div.withConfig({componentId:"jt-app__sc-50765fb0-2"})(["position:relative;"]),d=n.Ay.div.withConfig({componentId:"jt-app__sc-50765fb0-3"})(["position:absolute;inset:0;background:rgba(255,255,255,0.75);display:flex;align-items:center;justify-content:center;z-index:10;border-radius:",";"],e=>{let{theme:t}=e;return t.borderRadius.lg}),c=n.Ay.div.withConfig({componentId:"jt-app__sc-50765fb0-4"})(["text-align:center;p{margin-top:0.5rem;font-size:",";color:",";}"],e=>{let{theme:t}=e;return t.typography.fontSize.sm},e=>{let{theme:t}=e;return t.colors.text.secondary}),u=e=>{let{size:t="md",color:a="orange",className:n=""}=e;return(0,i.jsx)(s,{$size:t,$color:a,className:n,children:(0,i.jsxs)("svg",{width:"100%",height:"100%",fill:"none",viewBox:"0 0 24 24",children:[(0,i.jsx)("circle",{style:{opacity:.25},cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,i.jsx)("path",{style:{opacity:.75},fill:"currentColor",d:"m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})},h=e=>{let{isLoading:t,children:a,onClick:n,type:r="button",className:s="",disabled:l=!1}=e;return(0,i.jsxs)(o,{type:r,onClick:n,disabled:t||l,className:s,children:[t&&(0,i.jsx)(u,{size:"sm",color:"white"}),(0,i.jsx)("span",{children:a})]})},p=e=>{let{isLoading:t,message:a="Loading...",children:n}=e;return(0,i.jsxs)(l,{children:[n,t&&(0,i.jsx)(d,{children:(0,i.jsxs)(c,{children:[(0,i.jsx)(u,{size:"lg"}),(0,i.jsx)("p",{children:a})]})})]})}},47921:(e,t,a)=>{"use strict";a.d(t,{CP:()=>c,Tk:()=>l,Z2:()=>o,cV:()=>d});var i=a(95155),n=a(58347),r=a(12115);let s=(0,r.createContext)({hasNextAuth:!0}),o=()=>(0,r.useContext)(s);function l(){try{let{hasNextAuth:e}=o();if(!e)return{data:null,status:"unauthenticated"};return(0,n.wV)()}catch(e){return{data:null,status:"loading"}}}function d(){let{hasNextAuth:e}=o();return async t=>{if(e)return(0,n.signOut)(t);localStorage.removeItem("mobile-auth-session"),localStorage.removeItem("mobile-auth-user"),window.location.href="/mobile/login"}}function c(e){let{children:t}=e,[a,o]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{(async()=>{try{let e=new AbortController,t=setTimeout(()=>e.abort(),3e3),a=await fetch("/api/auth/session",{method:"GET",headers:{Accept:"application/json"},signal:e.signal});clearTimeout(t);let i=a.headers.get("content-type");if(a.ok&&(null==i?void 0:i.includes("application/json")))try{await a.json(),o(!0)}catch(e){o(!1)}else o(!1)}catch(e){o(!1)}})()},[]),(0,i.jsx)(s.Provider,{value:{hasNextAuth:a},children:a?(0,i.jsx)(n.CP,{children:t}):(0,i.jsx)(i.Fragment,{children:t})})}},56156:(e,t,a)=>{Promise.resolve().then(a.bind(a,84545))},66585:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var i=a(95155),n=a(35626),r=a(20063);function s(){let e=(0,r.useRouter)();return(0,i.jsxs)("button",{onClick:()=>e.push("/settings"),className:"inline-flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:[(0,i.jsx)(n.A,{className:"w-4 h-4"}),(0,i.jsx)("span",{className:"text-sm font-medium",children:"Back to Settings"})]})}},84545:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>N});var i=a(95155),n=a(12115),r=a(47921),s=a(20063),o=a(50625),l=a(39903),d=a(40294),c=a(66585);let u=o.Ay.div.withConfig({componentId:"jt-app__sc-441dba62-0"})(["min-height:100vh;background:linear-gradient(135deg,#ed7734 0%,#de5d20 100%);padding:20px;@media (max-width:768px){padding:10px;}"]),h=o.Ay.div.withConfig({componentId:"jt-app__sc-441dba62-1"})(["max-width:1400px;margin:0 auto;background:white;border-radius:12px;padding:30px;box-shadow:0 8px 32px rgba(0,0,0,0.1);@media (max-width:768px){padding:20px;}"]),p=o.Ay.div.withConfig({componentId:"jt-app__sc-441dba62-2"})(["display:flex;justify-content:between;align-items:center;margin-bottom:30px;flex-wrap:wrap;gap:20px;h1{margin:0;color:#333;font-size:28px;}@media (max-width:768px){flex-direction:column;align-items:stretch;}"]),x=o.Ay.div.withConfig({componentId:"jt-app__sc-441dba62-3"})(["display:flex;gap:15px;align-items:center;flex-wrap:wrap;select{padding:8px 12px;border:1px solid #d1d5db;border-radius:6px;background:white;color:#374151;font-size:14px;}"]),m=o.Ay.div.withConfig({componentId:"jt-app__sc-441dba62-4"})(["display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-bottom:30px;"]),g=o.Ay.div.withConfig({componentId:"jt-app__sc-441dba62-5"})(["background:white;border:1px solid #e5e7eb;border-radius:12px;padding:20px;box-shadow:0 2px 8px rgba(0,0,0,0.05);.icon{font-size:32px;margin-bottom:10px;}.value{font-size:32px;font-weight:700;color:#ed7734;margin-bottom:5px;}.label{font-size:14px;color:#6b7280;text-transform:uppercase;font-weight:600;margin-bottom:10px;}.change{font-size:12px;font-weight:600;&.positive{color:#10b981;}&.negative{color:#ef4444;}&.neutral{color:#6b7280;}}"]),v=o.Ay.div.withConfig({componentId:"jt-app__sc-441dba62-6"})(["margin-bottom:30px;"]),f=o.Ay.div.withConfig({componentId:"jt-app__sc-441dba62-7"})(["display:flex;justify-content:between;align-items:center;margin-bottom:20px;h3{margin:0;color:#333;font-size:20px;}"]),b=o.Ay.div.withConfig({componentId:"jt-app__sc-441dba62-8"})(["background:white;border:1px solid #e5e7eb;border-radius:12px;overflow:hidden;.header{background:#f9fafb;padding:15px 20px;border-bottom:1px solid #e5e7eb;font-weight:600;color:#374151;display:grid;grid-template-columns:2fr 1fr 1fr 1fr 1fr 1fr;gap:20px;@media (max-width:768px){display:none;}}.row{padding:15px 20px;border-bottom:1px solid #f3f4f6;display:grid;grid-template-columns:2fr 1fr 1fr 1fr 1fr 1fr;gap:20px;align-items:center;transition:background 0.2s ease;&:hover{background:#f9fafb;}&:last-child{border-bottom:none;}@media (max-width:768px){display:block;padding:20px;border-bottom:2px solid #f3f4f6;}}.location-info{.name{font-weight:600;color:#333;margin-bottom:5px;}.address{font-size:14px;color:#6b7280;}@media (max-width:768px){margin-bottom:15px;}}.metric{text-align:center;.value{font-weight:600;color:#333;margin-bottom:2px;}.label{font-size:12px;color:#6b7280;text-transform:uppercase;font-weight:600;}@media (max-width:768px){display:inline-block;margin-right:20px;text-align:left;.label{margin-right:5px;}.value{display:inline;}}}"]),j=o.Ay.span.withConfig({componentId:"jt-app__sc-441dba62-9"})(["padding:4px 12px;border-radius:20px;font-size:12px;font-weight:600;text-transform:uppercase;",""],e=>{switch(e.status){case"active":return"background: #dcfce7; color: #166534;";case"inactive":return"background: #fee2e2; color: #dc2626;";case"pending":return"background: #fef3c7; color: #92400e;";default:return"background: #f3f4f6; color: #6b7280;"}}),w=o.Ay.div.withConfig({componentId:"jt-app__sc-441dba62-10"})(["background:#f9fafb;border-radius:8px;padding:20px;height:300px;display:flex;align-items:center;justify-content:center;color:#6b7280;font-size:16px;"]),y=o.Ay.button.withConfig({componentId:"jt-app__sc-441dba62-11"})(["background:transparent;color:#ed7734;border:2px solid #ed7734;border-radius:8px;padding:8px 16px;font-size:14px;font-weight:600;cursor:pointer;transition:all 0.3s ease;&:hover{background:#ed7734;color:white;}"]);function N(){let{data:e,status:t}=(0,r.Tk)(),a=(0,s.useRouter)(),[o,N]=(0,n.useState)(!0),[C,k]=(0,n.useState)([]),[_,A]=(0,n.useState)([]),[z,L]=(0,n.useState)("30d"),[I,R]=(0,n.useState)("orders"),O=(0,n.useCallback)(async()=>{try{N(!0);let t=null==e?void 0:e.user,a=t.businessId||"biz_"+t.id,i=await l.DynamoDBService.getLocationsByBusinessId(a);k(i);let n="7d"===z?.25:"90d"===z?3:1,r=i.map(e=>{let t=Math.round(e.billing.monthlyUsage*n),a=35+25*Math.random();return{locationId:e.id,name:e.name,address:"".concat(e.address.city,", ").concat(e.address.state),status:e.billing.isActive?"active":"inactive",ordersCount:t,revenue:t*a,averageOrderValue:a,peakHours:["11AM-1PM","6PM-8PM"][Math.floor(2*Math.random())],utilizationRate:Math.min(100,100*Math.random()*n),monthlyGrowth:(Math.random()-.5)*30,lastOrderAt:t>0?new Date(Date.now()-7*Math.random()*864e5):void 0}});A(r)}catch(e){console.error("Error loading analytics:",e)}finally{N(!1)}},[e,z]);if((0,n.useEffect)(()=>{if("loading"!==t){if(!(null==e?void 0:e.user))return void a.push("/auth/signin");O()}},[e,t,a,O]),"loading"===t||o)return(0,i.jsx)(u,{children:(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh"},children:(0,i.jsx)(d.kt,{size:"lg"})})});if(!(null==e?void 0:e.user))return null;let S=_.reduce((e,t)=>({totalLocations:e.totalLocations+1,activeLocations:e.activeLocations+ +("active"===t.status),totalOrders:e.totalOrders+t.ordersCount,totalRevenue:e.totalRevenue+t.revenue,averageUtilization:e.averageUtilization+t.utilizationRate}),{totalLocations:0,activeLocations:0,totalOrders:0,totalRevenue:0,averageUtilization:0}),D=S.totalLocations>0?S.averageUtilization/S.totalLocations:0;return(0,i.jsx)(u,{children:(0,i.jsxs)(h,{children:[(0,i.jsx)(c.A,{}),(0,i.jsxs)(p,{children:[(0,i.jsx)("h1",{children:"Location Analytics"}),(0,i.jsxs)(x,{children:[(0,i.jsxs)("select",{value:z,onChange:e=>L(e.target.value),children:[(0,i.jsx)("option",{value:"7d",children:"Last 7 days"}),(0,i.jsx)("option",{value:"30d",children:"Last 30 days"}),(0,i.jsx)("option",{value:"90d",children:"Last 3 months"}),(0,i.jsx)("option",{value:"1y",children:"Last year"})]}),(0,i.jsx)(y,{onClick:()=>{let e=new Blob([[["Location","Status","Orders","Revenue","Avg Order Value","Peak Hours","Utilization %","Growth %"],..._.map(e=>[e.name,e.status,e.ordersCount,e.revenue.toFixed(2),e.averageOrderValue.toFixed(2),e.peakHours,e.utilizationRate.toFixed(1),e.monthlyGrowth.toFixed(1)])].map(e=>e.join(",")).join("\n")],{type:"text/csv"}),t=window.URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="location-analytics-".concat(new Date().toISOString().split("T")[0],".csv"),a.click(),window.URL.revokeObjectURL(t)},children:"Export Data"})]})]}),(0,i.jsxs)(m,{children:[(0,i.jsxs)(g,{children:[(0,i.jsx)("div",{className:"icon",children:"\uD83C\uDFEA"}),(0,i.jsx)("div",{className:"value",children:S.totalLocations}),(0,i.jsx)("div",{className:"label",children:"Total Locations"}),(0,i.jsxs)("div",{className:"change neutral",children:[S.activeLocations," active"]})]}),(0,i.jsxs)(g,{children:[(0,i.jsx)("div",{className:"icon",children:"\uD83D\uDCE6"}),(0,i.jsx)("div",{className:"value",children:S.totalOrders.toLocaleString()}),(0,i.jsx)("div",{className:"label",children:"Total Orders"}),(0,i.jsx)("div",{className:"change positive",children:"Across all locations"})]}),(0,i.jsxs)(g,{children:[(0,i.jsx)("div",{className:"icon",children:"\uD83D\uDCB0"}),(0,i.jsxs)("div",{className:"value",children:["$",S.totalRevenue.toFixed(0)]}),(0,i.jsx)("div",{className:"label",children:"Total Revenue"}),(0,i.jsxs)("div",{className:"change positive",children:["Last ",z]})]}),(0,i.jsxs)(g,{children:[(0,i.jsx)("div",{className:"icon",children:"\uD83D\uDCCA"}),(0,i.jsxs)("div",{className:"value",children:[D.toFixed(1),"%"]}),(0,i.jsx)("div",{className:"label",children:"Avg Utilization"}),(0,i.jsx)("div",{className:D>=75?"change positive":D>=50?"change neutral":"change negative",children:D>=75?"Excellent":D>=50?"Good":"Needs attention"})]})]}),(0,i.jsxs)(v,{children:[(0,i.jsxs)(f,{children:[(0,i.jsx)("h3",{children:"Performance Overview"}),(0,i.jsxs)("select",{value:I,onChange:e=>R(e.target.value),children:[(0,i.jsx)("option",{value:"orders",children:"Orders"}),(0,i.jsx)("option",{value:"revenue",children:"Revenue"}),(0,i.jsx)("option",{value:"utilization",children:"Utilization"})]})]}),(0,i.jsxs)(w,{children:["\uD83D\uDCC8 Performance chart would be displayed here",(0,i.jsx)("br",{}),"(Integration with charting library like Chart.js or Recharts recommended)"]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{style:{marginBottom:"20px",color:"#333"},children:"Location Performance Details"}),(0,i.jsxs)(b,{children:[(0,i.jsxs)("div",{className:"header",children:[(0,i.jsx)("div",{children:"Location"}),(0,i.jsx)("div",{children:"Status"}),(0,i.jsx)("div",{children:"Orders"}),(0,i.jsx)("div",{children:"Revenue"}),(0,i.jsx)("div",{children:"Avg Order"}),(0,i.jsx)("div",{children:"Utilization"})]}),_.map(e=>(0,i.jsxs)("div",{className:"row",children:[(0,i.jsxs)("div",{className:"location-info",children:[(0,i.jsx)("div",{className:"name",children:e.name}),(0,i.jsx)("div",{className:"address",children:e.address})]}),(0,i.jsx)("div",{className:"metric",children:(0,i.jsx)(j,{status:e.status,children:e.status})}),(0,i.jsxs)("div",{className:"metric",children:[(0,i.jsx)("div",{className:"value",children:e.ordersCount}),(0,i.jsx)("div",{className:"label",children:"Orders"})]}),(0,i.jsxs)("div",{className:"metric",children:[(0,i.jsxs)("div",{className:"value",children:["$",e.revenue.toFixed(0)]}),(0,i.jsx)("div",{className:"label",children:"Revenue"})]}),(0,i.jsxs)("div",{className:"metric",children:[(0,i.jsxs)("div",{className:"value",children:["$",e.averageOrderValue.toFixed(2)]}),(0,i.jsx)("div",{className:"label",children:"Avg Order"})]}),(0,i.jsxs)("div",{className:"metric",children:[(0,i.jsxs)("div",{className:"value",children:[e.utilizationRate.toFixed(1),"%"]}),(0,i.jsx)("div",{className:"label",children:"Utilization"})]})]},e.locationId)),0===_.length&&(0,i.jsx)("div",{style:{padding:"40px",textAlign:"center",color:"#6b7280"},children:"No location data available. Add locations to see analytics."})]})]})]})})}}},e=>{e.O(0,[2207,7646,8347,9903,8441,1255,7358],()=>e(e.s=56156)),_N_E=e.O()}]);