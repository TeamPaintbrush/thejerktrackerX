"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7694],{15824:(e,t,i)=>{i.d(t,{I:()=>h});var n=i(39903);let a="https://rqbyr7htb1.execute-api.us-east-1.amazonaws.com/prod".trim().replace(/\/$/,""),r="w15QRuSday4YHbK0FH3zc77mzY3nikKX6qEY2xZS",o="pSq4vhYdRnB7OUCkfQlo9M3z6rJEaD2F",s=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i={"Content-Type":"application/json"};return r&&(i["x-api-key"]=r),t&&o&&(i["X-Location-Admin-Key"]=o),{...i,...(e=>{if(!e)return{};if(e instanceof Headers){let t={};return e.forEach((e,i)=>{t[i]=e}),t}return Array.isArray(e)?e.reduce((e,t)=>{let[i,n]=t;return e[i]=n,e},{}):{...e}})(e)}};async function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=await fetch(e.startsWith("http")?e:a?"".concat(a).concat(e):e,{...t,headers:s(t.headers,i)});if(!n.ok)throw Error(await n.text().catch(()=>n.statusText)||"Request failed with status ".concat(n.status));if(204!==n.status)return n.json()}let d=e=>{if(e)return e instanceof Date?e:new Date(e)},l=e=>{var t;return{...e,createdAt:null!=(t=d(e.createdAt))?t:new Date,pickedUpAt:d(e.pickedUpAt),deliveredAt:d(e.deliveredAt)}},p=e=>{var t,i,n,a;return{...e,createdAt:null!=(n=d(e.createdAt))?n:new Date,updatedAt:d(e.updatedAt),billing:{...e.billing,activatedAt:d(null==(t=e.billing)?void 0:t.activatedAt),deactivatedAt:d(null==(i=e.billing)?void 0:i.deactivatedAt)},qrCodes:e.qrCodes?{...e.qrCodes,generated:null!=(a=d(e.qrCodes.generated))?a:new Date,lastUsed:d(e.qrCodes.lastUsed)}:e.qrCodes,verification:e.verification?{...e.verification,verifiedAt:d(e.verification.verifiedAt)}:e.verification}},m=e=>{var t;return{...e,createdAt:null!=(t=d(e.createdAt))?t:new Date,updatedAt:d(e.updatedAt)}};async function u(e,t){return l(await c("/api/orders/".concat(e),{method:"PATCH",body:JSON.stringify(t)}))}async function g(e,t){let i={status:t};return"picked_up"===t&&(i.pickedUpAt=new Date),"delivered"===t&&(i.deliveredAt=new Date),u(e,i)}let h={getAllOrders:async function(){return(await c("/api/orders/")).map(l)},getOrderById:async function(e){let t=await c("/api/orders/".concat(e));return t?l(t):null},createOrder:async function(e){if(a)try{let t=await c("/api/orders",{method:"POST",body:JSON.stringify(e)});return l(t)}catch(e){console.warn("Lambda API failed, falling back to direct DynamoDB:",e)}return console.log("\uD83D\uDCE1 Using direct DynamoDB for order creation"),await n.DynamoDBService.createOrder(e)},updateOrder:u,updateOrderStatus:g,getLocationsByBusinessId:async function(e){if(a)try{return((await c("/api/locations?businessId=".concat(encodeURIComponent(e)))).locations||[]).map(p)}catch(e){console.warn("Lambda API failed, falling back to direct DynamoDB:",e)}return console.log("\uD83D\uDCE1 Using direct DynamoDB for location fetching"),await n.DynamoDBService.getLocationsByBusinessId(e)},createLocation:async function(e){let t=await c("/api/locations",{method:"POST",body:JSON.stringify(e)},!0);return t.location?p(t.location):null},updateLocation:async function(e,t){return await c("/api/locations/".concat(e),{method:"PUT",body:JSON.stringify(t)},!0),!0},deleteLocation:async function(e){return await c("/api/locations/".concat(e),{method:"DELETE"},!0),!0},getMenuItems:async function(e,t,i){if(a)try{let n=new URLSearchParams({businessId:e});return t&&n.set("locationId",t),i&&n.set("search",i),((await c("/api/mobile/menu?".concat(n.toString()))).menuItems||[]).map(m)}catch(e){console.warn("Lambda API failed, falling back to direct DynamoDB:",e)}console.log("\uD83D\uDCE1 Using direct DynamoDB for menu fetching");let r=await n.DynamoDBService.getMenuItems(e);if(t&&(r=r.filter(e=>e.locationId===t)),i){let e=i.toLowerCase();r=r.filter(t=>{var i;return t.name.toLowerCase().includes(e)||(null==(i=t.description)?void 0:i.toLowerCase().includes(e))})}return r.map(m)}}},67694:(e,t,i)=>{i.r(t),i.d(t,{default:()=>eD});var n=i(95155),a=i(12115),r=i(50625),o=i(1733),s=i(26497),c=i(20063),d=i(32587),l=i(24995),p=i(21873),m=i(86651),u=i(12108),g=i(24033),h=i(6191),f=i(10512),y=i(7125),b=i(71360),w=i(42529),v=i(65229),x=i(15824),j=i(83361),C=i(96259),A=i(39903);async function k(){let e="test-business-001",t=await A.DynamoDBService.getLocationsByBusinessId(e);if(t&&t.length>0)return console.log("✅ Test locations already exist:",t.length),t;console.log("\uD83C\uDF31 Creating test locations for development...");let i=Date.now(),n=[{businessId:e,name:"Miami Beach Restaurant",address:{street:"1234 Ocean Drive",city:"Miami Beach",state:"FL",zipCode:"33139",country:"United States"},coordinates:{latitude:25.7907,longitude:-80.13},businessInfo:{businessName:"JERK Tracker Test Restaurant",businessType:"restaurant",businessPhone:"+1-305-555-0001",businessEmail:"miami@jerktrackertest.com"},verification:{status:"verified",method:"gps",verifiedAt:new Date,verificationDocument:"test-doc-001"},qrCodes:{primary:"qr-miami-".concat(i),backup:"qr-miami-backup-".concat(i),generated:new Date},billing:{isActive:!0,activatedAt:new Date,monthlyUsage:0},settings:{isActive:!0,timezone:"America/New_York",operatingHours:{monday:{open:"11:00",close:"22:00"},tuesday:{open:"11:00",close:"22:00"},wednesday:{open:"11:00",close:"22:00"},thursday:{open:"11:00",close:"22:00"},friday:{open:"11:00",close:"23:00"},saturday:{open:"11:00",close:"23:00"},sunday:{open:"12:00",close:"21:00"}},maxOrdersPerDay:100}},{businessId:e,name:"Brooklyn Downtown",address:{street:"456 Flatbush Avenue",city:"Brooklyn",state:"NY",zipCode:"11201",country:"United States"},coordinates:{latitude:40.6782,longitude:-73.9442},businessInfo:{businessName:"JERK Tracker Test Restaurant",businessType:"restaurant",businessPhone:"+1-718-555-0002",businessEmail:"brooklyn@jerktrackertest.com"},verification:{status:"verified",method:"gps",verifiedAt:new Date,verificationDocument:"test-doc-002"},qrCodes:{primary:"qr-brooklyn-".concat(i+1),backup:"qr-brooklyn-backup-".concat(i+1),generated:new Date},billing:{isActive:!0,activatedAt:new Date,monthlyUsage:0},settings:{isActive:!0,timezone:"America/New_York",operatingHours:{monday:{open:"10:00",close:"22:00"},tuesday:{open:"10:00",close:"22:00"},wednesday:{open:"10:00",close:"22:00"},thursday:{open:"10:00",close:"22:00"},friday:{open:"10:00",close:"23:00"},saturday:{open:"10:00",close:"23:00"},sunday:{open:"11:00",close:"21:00"}},maxOrdersPerDay:150}},{businessId:e,name:"Atlanta Midtown",address:{street:"789 Peachtree Street",city:"Atlanta",state:"GA",zipCode:"30308",country:"United States"},coordinates:{latitude:33.7756,longitude:-84.3857},businessInfo:{businessName:"JERK Tracker Test Restaurant",businessType:"restaurant",businessPhone:"+1-404-555-0003",businessEmail:"atlanta@jerktrackertest.com"},verification:{status:"verified",method:"gps",verifiedAt:new Date,verificationDocument:"test-doc-003"},qrCodes:{primary:"qr-atlanta-".concat(i+2),backup:"qr-atlanta-backup-".concat(i+2),generated:new Date},billing:{isActive:!0,activatedAt:new Date,monthlyUsage:0},settings:{isActive:!0,timezone:"America/New_York",operatingHours:{monday:{open:"09:00",close:"21:00"},tuesday:{open:"09:00",close:"21:00"},wednesday:{open:"09:00",close:"21:00"},thursday:{open:"09:00",close:"21:00"},friday:{open:"09:00",close:"22:00"},saturday:{open:"09:00",close:"22:00"},sunday:{open:"10:00",close:"20:00"}},maxOrdersPerDay:80}}],a=[];for(let e of n){let t=await A.DynamoDBService.createLocation(e);t&&(console.log("✅ Created: ".concat(t.name," (ID: ").concat(t.id,")")),a.push(t))}return console.log("\n✨ Created ".concat(a.length," test locations")),console.log("\uD83D\uDCCD Business ID: ".concat(e)),a}var I=i(72923);let _=r.Ay.div.withConfig({componentId:"jt-app__sc-59ce0fec-0"})(["padding:0.5rem 1rem;min-height:100vh;background:linear-gradient(135deg,#fef7ee 0%,#fafaf9 100%);padding-bottom:120px;"]),D=r.Ay.div.withConfig({componentId:"jt-app__sc-59ce0fec-1"})(["margin-top:0.5rem;margin-bottom:1.5rem;text-align:center;"]),S=r.Ay.h1.withConfig({componentId:"jt-app__sc-59ce0fec-2"})(["font-size:1.5rem;font-weight:700;color:#1f2937;margin:0 0 0.5rem 0;"]),T=r.Ay.p.withConfig({componentId:"jt-app__sc-59ce0fec-3"})(["font-size:1rem;color:#6b7280;margin:0;"]),P=r.Ay.div.withConfig({componentId:"jt-app__sc-59ce0fec-4"})(["display:flex;background:white;border-radius:12px;padding:4px;margin-bottom:1.5rem;box-shadow:0 1px 3px rgba(0,0,0,0.1);"]),N=r.Ay.button.withConfig({componentId:"jt-app__sc-59ce0fec-5"})(["flex:1;padding:0.75rem;border:none;border-radius:8px;font-size:0.875rem;font-weight:600;cursor:pointer;transition:all 0.2s;background:",";color:",";"],e=>e.$active?"#ed7734":"transparent",e=>e.$active?"white":"#6b7280"),z=r.Ay.div.withConfig({componentId:"jt-app__sc-59ce0fec-6"})(["background:white;border-radius:12px;padding:0.75rem;margin-bottom:1rem;display:flex;align-items:center;gap:0.5rem;box-shadow:0 1px 3px rgba(0,0,0,0.1);"]),L=r.Ay.input.withConfig({componentId:"jt-app__sc-59ce0fec-7"})(["flex:1;border:none;outline:none;font-size:0.875rem;&::placeholder{color:#9ca3af;}"]),O=r.Ay.div.withConfig({componentId:"jt-app__sc-59ce0fec-8"})(["margin-bottom:1.5rem;"]),E=r.Ay.div.withConfig({componentId:"jt-app__sc-59ce0fec-9"})(["display:flex;justify-content:space-between;align-items:center;padding:0.75rem 1rem;background:white;border-radius:12px;margin-bottom:0.5rem;cursor:pointer;box-shadow:0 1px 3px rgba(0,0,0,0.1);"]),R=r.Ay.h3.withConfig({componentId:"jt-app__sc-59ce0fec-10"})(["font-size:1rem;font-weight:600;color:#1f2937;margin:0;"]),F=(0,r.Ay)(o.P.div).withConfig({componentId:"jt-app__sc-59ce0fec-11"})(["background:white;border-radius:12px;padding:1rem;margin-bottom:0.75rem;box-shadow:0 1px 3px rgba(0,0,0,0.1);"]),q=r.Ay.div.withConfig({componentId:"jt-app__sc-59ce0fec-12"})(["display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:0.5rem;"]),B=r.Ay.div.withConfig({componentId:"jt-app__sc-59ce0fec-13"})(["flex:1;"]),M=r.Ay.h4.withConfig({componentId:"jt-app__sc-59ce0fec-14"})(["font-size:0.95rem;font-weight:600;color:#1f2937;margin:0 0 0.25rem 0;"]),U=r.Ay.p.withConfig({componentId:"jt-app__sc-59ce0fec-15"})(["font-size:1rem;font-weight:700;color:#ed7734;margin:0;"]),J=r.Ay.p.withConfig({componentId:"jt-app__sc-59ce0fec-16"})(["font-size:0.8rem;color:#6b7280;margin:0.5rem 0 0 0;line-height:1.4;"]),V=(0,r.Ay)(o.P.button).withConfig({componentId:"jt-app__sc-59ce0fec-17"})(["padding:0.5rem 1rem;background:#ed7734;color:white;border:none;border-radius:8px;font-size:0.875rem;font-weight:600;cursor:pointer;display:flex;align-items:center;gap:0.25rem;"]),Y=(0,r.Ay)(o.P.div).withConfig({componentId:"jt-app__sc-59ce0fec-18"})(["position:fixed;bottom:80px;left:1rem;right:1rem;background:white;border-radius:12px;padding:1rem;box-shadow:0 4px 12px rgba(0,0,0,0.15);z-index:100;"]),$=r.Ay.div.withConfig({componentId:"jt-app__sc-59ce0fec-19"})(["display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;"]),G=r.Ay.h3.withConfig({componentId:"jt-app__sc-59ce0fec-20"})(["font-size:1rem;font-weight:600;color:#1f2937;margin:0;"]),Q=r.Ay.div.withConfig({componentId:"jt-app__sc-59ce0fec-21"})(["display:flex;justify-content:space-between;align-items:center;padding:0.75rem 0;border-bottom:1px solid #f3f4f6;&:last-child{border-bottom:none;}"]),K=r.Ay.div.withConfig({componentId:"jt-app__sc-59ce0fec-22"})(["flex:1;"]),H=r.Ay.p.withConfig({componentId:"jt-app__sc-59ce0fec-23"})(["font-size:0.875rem;font-weight:600;color:#1f2937;margin:0 0 0.25rem 0;"]),W=r.Ay.p.withConfig({componentId:"jt-app__sc-59ce0fec-24"})(["font-size:0.8rem;color:#6b7280;margin:0;"]),X=r.Ay.div.withConfig({componentId:"jt-app__sc-59ce0fec-25"})(["display:flex;align-items:center;gap:0.75rem;"]),Z=r.Ay.button.withConfig({componentId:"jt-app__sc-59ce0fec-26"})(["width:28px;height:28px;border-radius:50%;border:1px solid #e5e7eb;background:white;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all 0.2s;&:hover{background:#f9fafb;border-color:#ed7734;}"]),ee=r.Ay.span.withConfig({componentId:"jt-app__sc-59ce0fec-27"})(["font-size:0.875rem;font-weight:600;color:#1f2937;min-width:20px;text-align:center;"]),et=r.Ay.div.withConfig({componentId:"jt-app__sc-59ce0fec-28"})(["display:flex;justify-content:space-between;align-items:center;padding-top:1rem;border-top:2px solid #f3f4f6;margin-top:1rem;"]),ei=r.Ay.span.withConfig({componentId:"jt-app__sc-59ce0fec-29"})(["font-size:1rem;font-weight:700;color:#1f2937;"]),en=r.Ay.span.withConfig({componentId:"jt-app__sc-59ce0fec-30"})(["font-size:1.25rem;font-weight:700;color:#ed7734;"]),ea=(0,r.Ay)(o.P.button).withConfig({componentId:"jt-app__sc-59ce0fec-31"})(["width:100%;padding:1rem;background:linear-gradient(135deg,#ed7734 0%,#dc6627 100%);color:white;border:none;border-radius:8px;font-size:1rem;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:0.5rem;margin-top:1rem;"]),er=(0,r.Ay)(o.P.div).withConfig({componentId:"jt-app__sc-59ce0fec-32"})(["position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;z-index:1000;padding:1rem;"]),eo=(0,r.Ay)(o.P.div).withConfig({componentId:"jt-app__sc-59ce0fec-33"})(["background:white;border-radius:16px;padding:1.5rem;width:100%;max-width:400px;max-height:90vh;overflow-y:auto;"]),es=(0,r.Ay)(o.P.div).withConfig({componentId:"jt-app__sc-59ce0fec-34"})(["position:fixed;inset:0;background:rgba(15,23,42,0.5);display:flex;align-items:center;justify-content:center;padding:1.25rem;z-index:1000;"]),ec=(0,r.Ay)(o.P.div).withConfig({componentId:"jt-app__sc-59ce0fec-35"})(["width:100%;max-width:360px;background:white;border-radius:20px;padding:1.5rem;text-align:center;box-shadow:0 30px 60px rgba(15,23,42,0.15);"]),ed=r.Ay.div.withConfig({componentId:"jt-app__sc-59ce0fec-36"})(["width:56px;height:56px;border-radius:50%;background:rgba(16,185,129,0.12);color:#059669;display:flex;align-items:center;justify-content:center;margin:0 auto 1rem auto;"]),el=r.Ay.h3.withConfig({componentId:"jt-app__sc-59ce0fec-37"})(["font-size:1.25rem;font-weight:700;color:#111827;margin:0 0 0.5rem 0;"]),ep=r.Ay.p.withConfig({componentId:"jt-app__sc-59ce0fec-38"})(["font-size:0.95rem;color:#4b5563;margin:0;"]),em=r.Ay.div.withConfig({componentId:"jt-app__sc-59ce0fec-39"})(["margin:1rem 0;padding:0.85rem 1rem;background:#f9fafb;border-radius:12px;text-align:left;font-size:0.875rem;color:#374151;display:flex;flex-direction:column;gap:0.35rem;"]),eu=r.Ay.span.withConfig({componentId:"jt-app__sc-59ce0fec-40"})(["font-weight:600;color:#111827;"]),eg=r.Ay.div.withConfig({componentId:"jt-app__sc-59ce0fec-41"})(["display:flex;flex-wrap:wrap;gap:0.75rem;margin-top:1.5rem;"]),eh=r.Ay.button.withConfig({componentId:"jt-app__sc-59ce0fec-42"})(["flex:1;min-width:130px;border:none;border-radius:10px;padding:0.85rem 1rem;font-size:0.95rem;font-weight:600;cursor:pointer;transition:transform 0.2s ease;background:",";color:",";&:active{transform:scale(0.98);}"],e=>"primary"===e.$variant?"#ed7734":"#f3f4f6",e=>"primary"===e.$variant?"white":"#111827"),ef=r.Ay.div.withConfig({componentId:"jt-app__sc-59ce0fec-43"})(["display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;"]),ey=r.Ay.h2.withConfig({componentId:"jt-app__sc-59ce0fec-44"})(["font-size:1.25rem;font-weight:700;color:#1f2937;margin:0;"]),eb=r.Ay.button.withConfig({componentId:"jt-app__sc-59ce0fec-45"})(["width:32px;height:32px;border-radius:50%;border:none;background:#f3f4f6;display:flex;align-items:center;justify-content:center;cursor:pointer;&:hover{background:#e5e7eb;}"]),ew=r.Ay.div.withConfig({componentId:"jt-app__sc-59ce0fec-46"})(["margin-bottom:1.25rem;"]),ev=r.Ay.label.withConfig({componentId:"jt-app__sc-59ce0fec-47"})(["display:block;font-size:0.875rem;font-weight:600;color:#1f2937;margin-bottom:0.5rem;"]),ex=r.Ay.input.withConfig({componentId:"jt-app__sc-59ce0fec-48"})(["width:100%;padding:0.75rem;border:1px solid #d1d5db;border-radius:8px;font-size:0.875rem;&:focus{outline:none;border-color:#ed7734;box-shadow:0 0 0 3px rgba(237,119,52,0.1);}"]),ej=r.Ay.div.withConfig({componentId:"jt-app__sc-59ce0fec-49"})(["text-align:center;padding:3rem 1rem;color:#9ca3af;"]),eC=(0,r.Ay)(o.P.div).withConfig({componentId:"jt-app__sc-59ce0fec-50"})(["background:",";color:white;padding:1rem;border-radius:12px;margin-bottom:1.5rem;display:flex;align-items:center;gap:0.75rem;box-shadow:0 2px 8px rgba(0,0,0,0.15);"],e=>"success"===e.$status?"linear-gradient(135deg, #10b981 0%, #059669 100%)":"error"===e.$status?"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)":"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)"),eA=r.Ay.div.withConfig({componentId:"jt-app__sc-59ce0fec-51"})(["flex:1;"]),ek=r.Ay.div.withConfig({componentId:"jt-app__sc-59ce0fec-52"})(["font-size:0.75rem;opacity:0.9;margin-bottom:0.25rem;"]),eI=r.Ay.div.withConfig({componentId:"jt-app__sc-59ce0fec-53"})(["font-size:0.95rem;font-weight:600;"]),e_=r.Ay.div.withConfig({componentId:"jt-app__sc-59ce0fec-54"})(["font-size:0.8rem;opacity:0.9;margin-top:0.25rem;"]);function eD(e){let{className:t,userRole:i="customer"}=e,r=(0,c.useRouter)(),[o,A]=(0,a.useState)("menu"),[eD,eS]=(0,a.useState)(""),[eT,eP]=(0,a.useState)({}),[eN,ez]=(0,a.useState)(new Set(j.Oz)),[eL,eO]=(0,a.useState)([]),[eE,eR]=(0,a.useState)(!1),[eF,eq]=(0,a.useState)(!1),[eB,eM]=(0,a.useState)({name:"",phone:"",address:""}),[eU,eJ]=(0,a.useState)(null),[eV,eY]=(0,a.useState)("detecting"),[e$,eG]=(0,a.useState)(""),[eQ,eK]=(0,a.useState)([]),[eH,eW]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{try{eY("detecting");let e=JSON.parse(localStorage.getItem("mobile_auth_user")||"{}"),t=(null==e?void 0:e.businessId)||(null==e?void 0:e.id)||"default-business";console.log("\uD83C\uDF0D Starting location detection for businessId:",t),await k();let i=await x.I.getLocationsByBusinessId(t);if(console.log("\uD83D\uDCCD Found locations:",i.length),eK(i),!i||0===i.length){eY("error"),eG("No locations configured for your business");return}if(1===i.length){eJ(i[0]),eY("success"),console.log("✅ Auto-selected single location:",i[0].name);return}console.log("\uD83D\uDCE1 Getting GPS position...");let n=await C.E.getCurrentLocation();if(!n){eY("error"),eG("Unable to access GPS. Please enable location services.");let e=i.find(e=>e.billing.isActive);e&&eJ(e);return}console.log("\uD83D\uDCCD GPS coordinates:",n);let a=await C.E.verifyLocationFromGPS(n,i.map(e=>({id:e.id,businessId:e.businessId,name:e.name,coordinates:e.coordinates,billing:e.billing})));if(console.log("\uD83D\uDD0D Verification result:",a),a.isValid&&a.locationId){let e=i.find(e=>e.id===a.locationId);e&&(eJ(e),eY("success"),console.log("✅ Location verified:",e.name,"(".concat(a.distance,"m away)")))}else if(eY("error"),eG(a.error||"Could not verify location"),a.locationId){let e=i.find(e=>e.id===a.locationId);e&&eJ(e)}}catch(e){console.error("❌ Location detection failed:",e),eY("error"),eG("Failed to detect location")}})()},[]),(0,a.useEffect)(()=>{(async()=>{try{let e=JSON.parse(localStorage.getItem("mobile_auth_user")||"{}"),t=(null==e?void 0:e.businessId)||(null==e?void 0:e.id)||"default-business";console.log("Loading menu for businessId:",t);let i=await x.I.getMenuItems(t);console.log("DB menu items:",(null==i?void 0:i.length)||0);let n={};(i||[]).forEach(e=>{let t=e.category;n[t]||(n[t]=[]),n[t].push(e)}),i&&0!==i.length||(console.log("No DB items found, adding preset examples"),[{id:"preset-jerk-chicken",name:"Jerk Chicken",description:"Authentic Jamaican jerk chicken with rice & peas",price:14.99,category:"Main Course",businessId:t,availability:{isAvailable:!0},createdAt:new Date,updatedAt:new Date},{id:"preset-jerk-pork",name:"Jerk Pork",description:"Spicy jerk pork with plantains",price:16.99,category:"Main Course",businessId:t,availability:{isAvailable:!0},createdAt:new Date,updatedAt:new Date},{id:"preset-rice-peas",name:"Rice & Peas",description:"Traditional coconut rice with kidney beans",price:5.99,category:"Sides",businessId:t,availability:{isAvailable:!0},createdAt:new Date,updatedAt:new Date},{id:"preset-plantains",name:"Fried Plantains",description:"Sweet fried plantains",price:4.99,category:"Sides",businessId:t,availability:{isAvailable:!0},createdAt:new Date,updatedAt:new Date},{id:"preset-sorrel",name:"Sorrel Drink",description:"Refreshing hibiscus drink",price:3.99,category:"Beverages",businessId:t,availability:{isAvailable:!0},createdAt:new Date,updatedAt:new Date}].forEach(e=>{n[e.category]||(n[e.category]=[]),n[e.category].push(e)})),console.log("Organized menu:",Object.keys(n),"categories"),eP(n)}catch(e){console.error("Failed to load menu:",e),eP({})}})()},[]);let eX=async e=>{d.Ii.isNativePlatform()&&await l.dn.impact({style:l.kn.Light}),eO(t=>t.find(t=>t.id===e.id)?t.map(t=>t.id===e.id?{...t,quantity:t.quantity+1}:t):[...t,{id:e.id,name:e.name,price:e.price,quantity:1}])},eZ=async(e,t)=>{d.Ii.isNativePlatform()&&await l.dn.impact({style:l.kn.Light}),eO(i=>i.map(i=>i.id===e?{...i,quantity:Math.max(0,i.quantity+t)}:i).filter(e=>e.quantity>0))},e0=async e=>{d.Ii.isNativePlatform()&&await l.dn.impact({style:l.kn.Medium}),eO(t=>t.filter(t=>t.id!==e))},e1=eL.reduce((e,t)=>e+t.price*t.quantity,0),e5=eL.reduce((e,t)=>e+t.quantity,0),e2=async()=>{0!==eL.length&&(d.Ii.isNativePlatform()&&await l.dn.impact({style:l.kn.Medium}),eR(!0))},e9=async()=>{if(!eB.name||!eB.phone)return void alert("Please fill in customer name and phone number");if(!eU)return void alert("❌ Location not detected\n\nPlease enable GPS or ensure you are at a registered location.");eq(!0);try{let e="ORDER-".concat(Date.now()),t=eU.qrCodes.primary||"qr-".concat(e,"-").concat(Math.random().toString(36).substr(2,9)),i=eL.map(e=>"".concat(e.quantity,"x ").concat(e.name," @ ").concat((0,j.$g)(e.price))).join("\n"),n={orderNumber:e,customerName:eB.name,customerEmail:eB.phone,orderDetails:i,status:"pending",location:{locationId:eU.id,businessId:eU.businessId,qrCodeId:t,verificationStatus:"success"===eV?"verified":"pending",coordinates:eU.coordinates,deviceInfo:"undefined"!=typeof navigator?navigator.userAgent:"Mobile App"}},a=await x.I.createOrder(n);await I.B.sendNotificationToRole("manager",{title:"\uD83C\uDD95 New Order Received",body:"Order ".concat(e," from ").concat(eB.name),data:{type:"new_order",orderId:a.id,orderNumber:a.orderNumber}}),d.Ii.isNativePlatform()&&await l.dn.impact({style:l.kn.Heavy}),eO([]),eM({name:"",phone:"",address:""}),eR(!1),eW({orderId:a.id,orderNumber:a.orderNumber,locationName:eU.name,total:e1})}catch(t){console.error("Failed to create order:",t);let e=t instanceof Error?t.message:"Unknown error";alert("❌ Failed to create order\n\n".concat(e))}finally{eq(!1)}},e3=Object.entries(eT).reduce((e,t)=>{let[i,n]=t;if(eD){let t=n.filter(e=>{var t;return e.name.toLowerCase().includes(eD.toLowerCase())||(null==(t=e.description)?void 0:t.toLowerCase().includes(eD.toLowerCase()))});t.length>0&&(e[i]=t)}else e[i]=n;return e},{});return(0,n.jsxs)(_,{className:t,children:[(0,n.jsxs)(D,{children:[(0,n.jsx)(S,{children:"Create Order Tracker"}),(0,n.jsx)(T,{children:"Select items from menu & generate QR tracker"})]}),(0,n.jsx)(s.N,{children:"detecting"!==eV&&(0,n.jsxs)(eC,{$status:eV,initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:[(0,n.jsx)(p.A,{size:24}),(0,n.jsxs)(eA,{children:["success"===eV&&eU&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ek,{children:"\uD83D\uDCCD Auto-detected Location"}),(0,n.jsx)(eI,{children:eU.name}),(0,n.jsxs)(e_,{children:[eU.address.city,", ",eU.address.state]})]}),"error"===eV&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ek,{children:"⚠️ Location Detection"}),(0,n.jsx)(eI,{children:e$}),eU&&(0,n.jsxs)(e_,{children:["Using: ",eU.name]})]})]})]})}),(0,n.jsxs)(P,{children:[(0,n.jsxs)(N,{$active:"menu"===o,onClick:()=>A("menu"),children:["Menu (",Object.values(eT).flat().length,")"]}),(0,n.jsxs)(N,{$active:"cart"===o,onClick:()=>A("cart"),children:["Cart (",e5,")"]})]}),"menu"===o&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(z,{children:[(0,n.jsx)(m.A,{size:18,color:"#9ca3af"}),(0,n.jsx)(L,{type:"text",placeholder:"Search menu items...",value:eD,onChange:e=>eS(e.target.value)})]}),0===Object.keys(e3).length?(0,n.jsx)(ej,{children:(0,n.jsx)("p",{children:"No menu items found"})}):Object.entries(e3).map(e=>{let[t,i]=e;return(0,n.jsxs)(O,{children:[(0,n.jsxs)(E,{onClick:()=>{ez(e=>{let i=new Set(e);return i.has(t)?i.delete(t):i.add(t),i})},children:[(0,n.jsxs)(R,{children:[t," (",i.length,")"]}),eN.has(t)?(0,n.jsx)(u.A,{size:20}):(0,n.jsx)(g.A,{size:20})]}),(0,n.jsx)(s.N,{children:eN.has(t)&&i.map(e=>(0,n.jsx)(F,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:(0,n.jsxs)(q,{children:[(0,n.jsxs)(B,{children:[(0,n.jsx)(M,{children:e.name}),(0,n.jsx)(U,{children:(0,j.$g)(e.price)}),e.description&&(0,n.jsx)(J,{children:e.description})]}),(0,n.jsxs)(V,{whileTap:{scale:.95},onClick:()=>eX(e),children:[(0,n.jsx)(h.A,{size:16}),"Add"]})]})},e.id))})]},t)})]}),"cart"===o&&(0,n.jsx)("div",{style:{paddingBottom:"200px"},children:0===eL.length?(0,n.jsxs)(ej,{children:[(0,n.jsx)(f.A,{size:48,style:{marginBottom:"1rem"}}),(0,n.jsx)("p",{children:"Your cart is empty"}),(0,n.jsx)("p",{style:{fontSize:"0.875rem"},children:"Add items from the menu to get started"})]}):eL.map(e=>(0,n.jsxs)(Q,{children:[(0,n.jsxs)(K,{children:[(0,n.jsx)(H,{children:e.name}),(0,n.jsxs)(W,{children:[(0,j.$g)(e.price)," each"]})]}),(0,n.jsxs)(X,{children:[(0,n.jsx)(Z,{onClick:()=>eZ(e.id,-1),children:(0,n.jsx)(y.A,{size:14})}),(0,n.jsx)(ee,{children:e.quantity}),(0,n.jsx)(Z,{onClick:()=>eZ(e.id,1),children:(0,n.jsx)(h.A,{size:14})}),(0,n.jsx)(Z,{onClick:()=>e0(e.id),children:(0,n.jsx)(b.A,{size:14,color:"#dc2626"})})]})]},e.id))}),(0,n.jsx)(s.N,{children:eL.length>0&&(0,n.jsxs)(Y,{initial:{y:100,opacity:0},animate:{y:0,opacity:1},exit:{y:100,opacity:0},children:[(0,n.jsx)($,{children:(0,n.jsxs)(G,{children:[(0,n.jsx)(f.A,{size:20,style:{display:"inline",marginRight:"0.5rem"}}),e5," ",1===e5?"item":"items"]})}),(0,n.jsxs)(et,{children:[(0,n.jsx)(ei,{children:"Total"}),(0,n.jsx)(en,{children:(0,j.$g)(e1)})]}),(0,n.jsxs)(ea,{whileTap:{scale:.98},onClick:e2,children:[(0,n.jsx)(w.A,{size:20}),"Proceed to Checkout"]})]})}),(0,n.jsx)(s.N,{children:eE&&(0,n.jsx)(er,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>!eF&&eR(!1),children:(0,n.jsxs)(eo,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:e=>e.stopPropagation(),children:[(0,n.jsxs)(ef,{children:[(0,n.jsx)(ey,{children:"Customer Details"}),(0,n.jsx)(eb,{onClick:()=>eR(!1),disabled:eF,children:(0,n.jsx)(v.A,{size:18})})]}),(0,n.jsxs)(ew,{children:[(0,n.jsx)(ev,{children:"Customer Name *"}),(0,n.jsx)(ex,{type:"text",placeholder:"Enter customer name",value:eB.name,onChange:e=>eM(t=>({...t,name:e.target.value})),disabled:eF})]}),(0,n.jsxs)(ew,{children:[(0,n.jsx)(ev,{children:"Phone Number *"}),(0,n.jsx)(ex,{type:"tel",placeholder:"+1 (555) 000-0000",value:eB.phone,onChange:e=>eM(t=>({...t,phone:e.target.value})),disabled:eF})]}),(0,n.jsxs)(ew,{children:[(0,n.jsx)(ev,{children:"Delivery Address (Optional)"}),(0,n.jsx)(ex,{type:"text",placeholder:"Enter delivery address",value:eB.address,onChange:e=>eM(t=>({...t,address:e.target.value})),disabled:eF})]}),(0,n.jsxs)("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"#f9fafb",borderRadius:"8px"},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[(0,n.jsx)("span",{style:{fontSize:"0.875rem",color:"#6b7280"},children:"Items:"}),(0,n.jsx)("span",{style:{fontSize:"0.875rem",fontWeight:600},children:e5})]}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,n.jsx)("span",{style:{fontSize:"1rem",fontWeight:700},children:"Total:"}),(0,n.jsx)("span",{style:{fontSize:"1rem",fontWeight:700,color:"#ed7734"},children:(0,j.$g)(e1)})]})]}),(0,n.jsx)(ea,{whileTap:{scale:eF?1:.98},onClick:e9,disabled:eF,style:{marginTop:"1.5rem"},children:eF?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.A,{size:20}),"Creating Order..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(w.A,{size:20}),"Create QR Code Order Tracker"]})})]})})}),(0,n.jsx)(s.N,{children:eH&&(0,n.jsx)(es,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,n.jsxs)(ec,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:e=>e.stopPropagation(),children:[(0,n.jsx)(ed,{children:(0,n.jsx)(w.A,{size:28})}),(0,n.jsx)(el,{children:"Order Tracker created successfully!"}),(0,n.jsx)(ep,{children:"QR code is ready for driver pickup tracking."}),(0,n.jsxs)(em,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(eu,{children:"Order:"})," #",eH.orderNumber]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(eu,{children:"Location:"})," ",eH.locationName]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(eu,{children:"Total:"})," ",(0,j.$g)(eH.total)]})]}),(0,n.jsxs)(eg,{children:[(0,n.jsx)(eh,{type:"button",onClick:()=>{if(!eH)return;let e=eH.orderId;eW(null),r.push("/mobile/orders/".concat(e))},children:"OK"}),(0,n.jsx)(eh,{type:"button",$variant:"primary",onClick:()=>{if(!eH)return;let e=eH.orderId;eW(null);let t="/mobile/qr?tab=orders&orderId=".concat(encodeURIComponent(e));r.push(t)},children:"Go to QR Tracker"})]})]})})})]})}},72923:(e,t,i)=>{i.d(t,{B:()=>r});var n=i(32587),a=i(81494);i(12115);class r{static async initialize(e){if(!n.Ii.isNativePlatform())return console.log("Push notifications only available on native platforms"),!1;this.userId=e.userId,this.userRole=e.userRole;try{let e=await a.h.requestPermissions();if("granted"===e.receive)return await a.h.register(),this.setupListeners(),console.log("✅ Push notifications initialized successfully"),!0;return console.warn("⚠️ Push notification permission denied"),!1}catch(e){return console.error("❌ Failed to initialize push notifications:",e),!1}}static setupListeners(){let e=a.h.addListener("registration",async e=>{this.deviceToken=e.value,console.log("\uD83D\uDCF1 Device token received:",e.value),await this.registerDeviceWithBackend(e.value)});this.listeners.push(e);let t=a.h.addListener("registrationError",e=>{console.error("❌ Push registration error:",e)});this.listeners.push(t);let i=a.h.addListener("pushNotificationReceived",e=>{console.log("\uD83D\uDD14 Notification received (foreground):",e),this.handleForegroundNotification(e)});this.listeners.push(i);let n=a.h.addListener("pushNotificationActionPerformed",e=>{console.log("\uD83D\uDC46 Notification action:",e),this.handleNotificationAction(e)});this.listeners.push(n)}static async registerDeviceWithBackend(e){if(!this.userId||!this.userRole)return void console.warn("User info not set, skipping backend registration");try{(await fetch("/api/push/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:this.userId,userRole:this.userRole,deviceToken:e,platform:n.Ii.getPlatform(),timestamp:new Date().toISOString()})})).ok?console.log("✅ Device registered with backend"):console.error("❌ Failed to register device with backend")}catch(e){console.error("❌ Error registering device:",e)}}static handleForegroundNotification(e){let t=e.data;console.log("Foreground notification:",{title:e.title,body:e.body,data:t}),(null==t?void 0:t.type)&&(null==t?void 0:t.orderId)&&this.handleOrderNotification(t)}static handleNotificationAction(e){let t=e.notification.data;console.log("User tapped notification:",t),t.type&&t.orderId?this.navigateToOrder(t.orderId):t.type&&t.claimId&&this.navigatToFraudClaim(t.claimId)}static handleOrderNotification(e){let t=new CustomEvent("orderNotificationReceived",{detail:e});window.dispatchEvent(t)}static navigateToOrder(e){window.location.href="/mobile/orders/".concat(e)}static navigatToFraudClaim(e){window.location.href="/mobile/fraud-claims?claim=".concat(e)}static async sendNotificationToUser(e,t){try{return(await fetch("/api/push/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({targetUserId:e,notification:t})})).ok}catch(e){return console.error("Failed to send notification:",e),!1}}static async sendNotificationToRole(e,t){try{return(await fetch("/api/push/send-to-role",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({role:e,notification:t})})).ok}catch(e){return console.error("Failed to send notification to role:",e),!1}}static async getDeliveryChannels(){return(await a.h.listChannels()).channels}static async createChannel(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4;"android"===n.Ii.getPlatform()&&await a.h.createChannel({id:e,name:t,importance:i,sound:"default",vibration:!0,lights:!0,lightColor:"#ED7734"})}static async setupDefaultChannels(){"android"===n.Ii.getPlatform()&&(await this.createChannel("orders","Order Updates",5),await this.createChannel("fraud","Fraud Alerts",5),await this.createChannel("general","General Notifications",3))}static getDeviceToken(){return this.deviceToken}static isAvailable(){return n.Ii.isNativePlatform()}static cleanup(){this.listeners.forEach(e=>e.remove()),this.listeners=[]}static async notifyOrderStatus(e,t,i,n){return await this.sendNotificationToUser(n,{title:"Order ".concat(t),body:{pending:"\uD83D\uDCCB Your order has been received",in_progress:"\uD83D\uDC68‍\uD83C\uDF73 Your order is being prepared",ready:"✅ Your order is ready for pickup!",picked_up:"\uD83D\uDE97 Your order has been picked up",delivered:"\uD83C\uDF89 Your order has been delivered!",cancelled:"❌ Your order has been cancelled"}[i]||"Order status updated",data:{type:"order_status",orderId:e,orderNumber:t,status:i}})}static async notifyNewFraudClaim(e,t){return await this.sendNotificationToRole("admin",{title:"\uD83D\uDEA8 New Fraud Claim",body:"Claim ".concat(e," filed for order ").concat(t),data:{type:"new_fraud_claim",claimNumber:e,orderNumber:t}})}}r.deviceToken=null,r.userId=null,r.userRole=null,r.listeners=[]},83361:(e,t,i)=>{i.d(t,{$Y:()=>o,$g:()=>d,IT:()=>a,J4:()=>r,N:()=>s,Oz:()=>n,s5:()=>c,z_:()=>l});let n=[{id:"mains",name:"Main Dishes",description:"Our signature jerk dishes and hearty mains",icon:"\uD83C\uDF56"},{id:"sides",name:"Sides",description:"Perfect accompaniments to your meal",icon:"\uD83C\uDF5A"},{id:"appetizers",name:"Appetizers",description:"Start your meal right",icon:"\uD83E\uDD58"},{id:"beverages",name:"Beverages",description:"Refresh yourself with our drinks",icon:"\uD83E\uDD64"},{id:"desserts",name:"Desserts",description:"Sweet endings to your meal",icon:"\uD83C\uDF70"}],a=[{id:"jerk-chicken-combo",name:"Jerk Chicken Combo",description:"Our signature jerk chicken with rice & peas, coleslaw, and plantains",price:16.99,category:"mains",popular:!0,spiceLevel:"medium",preparationTime:15,allergens:["soy"]},{id:"curry-goat",name:"Curry Goat",description:"Tender goat meat slow-cooked in aromatic curry spices, served with rice",price:19.99,category:"mains",popular:!0,spiceLevel:"mild",preparationTime:20,allergens:[]},{id:"ackee-saltfish",name:"Ackee & Saltfish",description:"Jamaica's national dish with boiled green bananas and dumplings",price:17.99,category:"mains",spiceLevel:"mild",preparationTime:12,allergens:["fish"]},{id:"jerk-pork",name:"Jerk Pork",description:"Spicy marinated pork shoulder, grilled to perfection",price:18.99,category:"mains",spiceLevel:"hot",preparationTime:18,allergens:["soy"]},{id:"brown-stew-chicken",name:"Brown Stew Chicken",description:"Chicken pieces braised in rich brown sauce with vegetables",price:15.99,category:"mains",spiceLevel:"mild",preparationTime:16,allergens:[]},{id:"escovitch-fish",name:"Escovitch Fish",description:"Fried snapper topped with spicy pickled vegetables",price:21.99,category:"mains",spiceLevel:"medium",preparationTime:14,allergens:["fish"]},{id:"oxtail-stew",name:"Oxtail Stew",description:"Fall-off-the-bone oxtail braised with butter beans",price:23.99,category:"mains",popular:!0,spiceLevel:"mild",preparationTime:25,allergens:[]},{id:"rice-peas",name:"Rice & Peas",description:"Coconut rice cooked with kidney beans and spices",price:4.99,category:"sides",popular:!0,preparationTime:5,allergens:[]},{id:"plantains",name:"Sweet Plantains",description:"Caramelized ripe plantains",price:3.99,category:"sides",preparationTime:8,allergens:[]},{id:"festival",name:"Festival",description:"Sweet fried dumplings, crispy outside and soft inside",price:2.99,category:"sides",preparationTime:6,allergens:["gluten"]},{id:"coleslaw",name:"Coleslaw",description:"Fresh cabbage and carrot salad with tangy dressing",price:3.49,category:"sides",preparationTime:2,allergens:["dairy"]},{id:"mac-cheese",name:"Mac & Cheese",description:"Creamy baked macaroni and cheese",price:5.99,category:"sides",preparationTime:4,allergens:["dairy","gluten"]},{id:"steamed-vegetables",name:"Steamed Vegetables",description:"Fresh seasonal vegetables lightly steamed",price:4.49,category:"sides",preparationTime:6,allergens:[]},{id:"jamaican-patties",name:"Jamaican Beef Patties",description:"Flaky pastry filled with spiced ground beef (2 pieces)",price:6.99,category:"appetizers",popular:!0,spiceLevel:"medium",preparationTime:8,allergens:["gluten"]},{id:"chicken-patties",name:"Jamaican Chicken Patties",description:"Flaky pastry filled with seasoned chicken (2 pieces)",price:6.99,category:"appetizers",spiceLevel:"mild",preparationTime:8,allergens:["gluten"]},{id:"saltfish-fritters",name:"Saltfish Fritters",description:"Crispy fried fritters with saltfish and scotch bonnet (6 pieces)",price:8.99,category:"appetizers",spiceLevel:"medium",preparationTime:10,allergens:["fish","gluten"]},{id:"sorrel-drink",name:"Sorrel Drink",description:"Traditional hibiscus drink with ginger and spices",price:3.99,category:"beverages",popular:!0,preparationTime:2,allergens:[]},{id:"ginger-beer",name:"Jamaican Ginger Beer",description:"Spicy homemade ginger beer",price:3.49,category:"beverages",spiceLevel:"medium",preparationTime:2,allergens:[]},{id:"coconut-water",name:"Fresh Coconut Water",description:"Pure coconut water from young coconuts",price:4.99,category:"beverages",preparationTime:3,allergens:[]},{id:"rum-punch",name:"Virgin Rum Punch",description:"Non-alcoholic tropical fruit punch",price:4.49,category:"beverages",preparationTime:3,allergens:[]},{id:"rum-cake",name:"Jamaican Rum Cake",description:"Moist cake soaked in rum syrup (alcohol-free version available)",price:6.99,category:"desserts",popular:!0,preparationTime:3,allergens:["gluten","dairy","eggs"]},{id:"coconut-drops",name:"Coconut Drops",description:"Sweet coconut candy with ginger (4 pieces)",price:4.99,category:"desserts",preparationTime:2,allergens:[]},{id:"plantain-tart",name:"Plantain Tart",description:"Sweet plantain custard tart",price:5.99,category:"desserts",preparationTime:4,allergens:["gluten","dairy","eggs"]}],r=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!t)return e;let i=[...e],n=new Set(e.map(e=>e.id));return a.forEach(e=>{n.has(e.id)||i.push(e)}),i},o=(e,t)=>e.filter(e=>e.category===t),s=e=>e.filter(e=>e.popular),c=(e,t)=>{let i=t.toLowerCase();return e.filter(e=>{var t;return e.name.toLowerCase().includes(i)||e.description.toLowerCase().includes(i)||(null==(t=e.allergens)?void 0:t.some(e=>e.toLowerCase().includes(i)))})},d=e=>"$".concat(e.toFixed(2)),l=e=>{switch(e){case"mild":return"\uD83C\uDF36️";case"medium":return"\uD83C\uDF36️\uD83C\uDF36️";case"hot":return"\uD83C\uDF36️\uD83C\uDF36️\uD83C\uDF36️";case"extra-hot":return"\uD83C\uDF36️\uD83C\uDF36️\uD83C\uDF36️\uD83D\uDD25";default:return""}}},96259:(e,t,i)=>{i.d(t,{E:()=>a});var n=i(95704);class a{static async getCurrentLocation(){return new Promise(e=>{if(!navigator.geolocation){console.warn("Geolocation is not supported by this browser"),e(null);return}navigator.geolocation.getCurrentPosition(t=>{e({latitude:t.coords.latitude,longitude:t.coords.longitude,accuracy:t.coords.accuracy})},t=>{console.error("Error getting location:",t),e(null)},{enableHighAccuracy:!0,timeout:this.GEOLOCATION_TIMEOUT,maximumAge:6e4})})}static calculateDistance(e,t,i,n){let a=this.toRadians(i-e),r=this.toRadians(n-t),o=Math.sin(a/2)*Math.sin(a/2)+Math.cos(this.toRadians(e))*Math.cos(this.toRadians(i))*Math.sin(r/2)*Math.sin(r/2);return 2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))*6371e3}static toRadians(e){return Math.PI/180*e}static async verifyLocationFromGPS(e,t){try{let i=null,n=1/0;for(let a of t){if(!a.billing.isActive)continue;let t=this.calculateDistance(e.latitude,e.longitude,a.coordinates.latitude,a.coordinates.longitude);t<n&&(n=t,i=a)}if(!i)return{isValid:!1,error:"No active locations found",method:"gps",coordinates:e};if(n<=this.MAX_DISTANCE_METERS)return{isValid:!0,locationId:i.id,businessId:i.businessId,distance:Math.round(n),method:"gps",coordinates:e};return{isValid:!1,locationId:i.id,businessId:i.businessId,distance:Math.round(n),error:"Location verification failed. You are ".concat(Math.round(n),"m away from ").concat(i.name,". Please be within ").concat(this.MAX_DISTANCE_METERS,"m to place an order."),method:"gps",coordinates:e}}catch(t){return console.error("Error verifying location:",t),{isValid:!1,error:"Failed to verify location",method:"gps",coordinates:e}}}static async verifyLocationFromQRCode(e,t){try{let i=t.find(t=>t.billing.isActive&&(t.qrCodes.primary===e||t.qrCodes.backup===e));if(i)return{isValid:!0,locationId:i.id,businessId:i.businessId,method:"qr_code"};return{isValid:!1,error:"Invalid QR code or location not active",method:"qr_code"}}catch(e){return console.error("Error verifying QR code location:",e),{isValid:!1,error:"Failed to verify QR code location",method:"qr_code"}}}static async verifyLocationFromIP(){try{let e=n.env.NEXT_PUBLIC_IPSTACK_API_KEY;if(e)try{let t=await fetch("https://api.ipify.org?format=json"),i=(await t.json()).ip,n=await fetch("http://api.ipstack.com/".concat(i,"?access_key=").concat(e));if(n.ok){let e=await n.json();if(e.latitude&&e.longitude)return{isValid:!0,method:"ip_address",coordinates:{latitude:e.latitude,longitude:e.longitude},metadata:{city:e.city,country:e.country_name,region:e.region_name}}}}catch(e){console.error("IPStack API error:",e)}console.warn("Using fallback IP geolocation - add NEXT_PUBLIC_IPSTACK_API_KEY for production");return{isValid:!0,method:"ip_address",coordinates:{latitude:40.7128,longitude:-74.006},metadata:{city:"New York",country:"US",fallback:!0}}}catch(e){return console.error("Error getting IP location:",e),{isValid:!1,error:"Failed to determine location from IP",method:"ip_address"}}}static async verifyLocationForOrder(e,t){try{if(e&&t){let i=await this.verifyLocationFromQRCode(e,t);if(i.isValid)return i}if(t){let e=await this.getCurrentLocation();if(e){let i=await this.verifyLocationFromGPS(e,t);return i.isValid,i}}return{...await this.verifyLocationFromIP(),isValid:!1,error:"Please enable location services or scan a valid QR code to place an order"}}catch(e){return console.error("Comprehensive location verification failed:",e),{isValid:!1,error:"Unable to verify your location. Please try again.",method:"manual"}}}static getDeviceFingerprint(){let e=document.createElement("canvas"),t=e.getContext("2d");t&&(t.textBaseline="top",t.font="14px Arial",t.fillText("Device fingerprint",2,2));let i=[navigator.userAgent,navigator.language,screen.width+"x"+screen.height,new Date().getTimezoneOffset(),e.toDataURL()].join("|"),n=0;for(let e=0;e<i.length;e++)n=(n<<5)-n+i.charCodeAt(e),n&=n;return n.toString()}static isLocationVerificationRequired(e){return(null==e?void 0:e.requireLocationVerification)!==!1}}a.MAX_DISTANCE_METERS=100,a.GEOLOCATION_TIMEOUT=1e4}}]);