"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9214],{15824:(e,t,r)=>{r.d(t,{I:()=>g});var i=r(39903);let n="https://rqbyr7htb1.execute-api.us-east-1.amazonaws.com/prod".trim().replace(/\/$/,""),a="w15QRuSday4YHbK0FH3zc77mzY3nikKX6qEY2xZS",o="pSq4vhYdRnB7OUCkfQlo9M3z6rJEaD2F",c=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r={"Content-Type":"application/json"};return a&&(r["x-api-key"]=a),t&&o&&(r["X-Location-Admin-Key"]=o),{...r,...(e=>{if(!e)return{};if(e instanceof Headers){let t={};return e.forEach((e,r)=>{t[r]=e}),t}return Array.isArray(e)?e.reduce((e,t)=>{let[r,i]=t;return e[r]=i,e},{}):{...e}})(e)}};async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=await fetch(e.startsWith("http")?e:n?"".concat(n).concat(e):e,{...t,headers:c(t.headers,r)});if(!i.ok)throw Error(await i.text().catch(()=>i.statusText)||"Request failed with status ".concat(i.status));if(204!==i.status)return i.json()}let d=e=>{if(e)return e instanceof Date?e:new Date(e)},l=e=>{var t;return{...e,createdAt:null!=(t=d(e.createdAt))?t:new Date,pickedUpAt:d(e.pickedUpAt),deliveredAt:d(e.deliveredAt)}},p=e=>{var t,r,i,n;return{...e,createdAt:null!=(i=d(e.createdAt))?i:new Date,updatedAt:d(e.updatedAt),billing:{...e.billing,activatedAt:d(null==(t=e.billing)?void 0:t.activatedAt),deactivatedAt:d(null==(r=e.billing)?void 0:r.deactivatedAt)},qrCodes:e.qrCodes?{...e.qrCodes,generated:null!=(n=d(e.qrCodes.generated))?n:new Date,lastUsed:d(e.qrCodes.lastUsed)}:e.qrCodes,verification:e.verification?{...e.verification,verifiedAt:d(e.verification.verifiedAt)}:e.verification}},u=e=>{var t;return{...e,createdAt:null!=(t=d(e.createdAt))?t:new Date,updatedAt:d(e.updatedAt)}};async function m(e,t){return l(await s("/api/orders/".concat(e),{method:"PATCH",body:JSON.stringify(t)}))}async function f(e,t){let r={status:t};return"picked_up"===t&&(r.pickedUpAt=new Date),"delivered"===t&&(r.deliveredAt=new Date),m(e,r)}let g={getAllOrders:async function(){return(await s("/api/orders/")).map(l)},getOrderById:async function(e){let t=await s("/api/orders/".concat(e));return t?l(t):null},createOrder:async function(e){if(n)try{let t=await s("/api/orders",{method:"POST",body:JSON.stringify(e)});return l(t)}catch(e){console.warn("Lambda API failed, falling back to direct DynamoDB:",e)}return console.log("\uD83D\uDCE1 Using direct DynamoDB for order creation"),await i.DynamoDBService.createOrder(e)},updateOrder:m,updateOrderStatus:f,getLocationsByBusinessId:async function(e){if(n)try{return((await s("/api/locations?businessId=".concat(encodeURIComponent(e)))).locations||[]).map(p)}catch(e){console.warn("Lambda API failed, falling back to direct DynamoDB:",e)}return console.log("\uD83D\uDCE1 Using direct DynamoDB for location fetching"),await i.DynamoDBService.getLocationsByBusinessId(e)},createLocation:async function(e){let t=await s("/api/locations",{method:"POST",body:JSON.stringify(e)},!0);return t.location?p(t.location):null},updateLocation:async function(e,t){return await s("/api/locations/".concat(e),{method:"PUT",body:JSON.stringify(t)},!0),!0},deleteLocation:async function(e){return await s("/api/locations/".concat(e),{method:"DELETE"},!0),!0},getMenuItems:async function(e,t,r){if(n)try{let i=new URLSearchParams({businessId:e});return t&&i.set("locationId",t),r&&i.set("search",r),((await s("/api/mobile/menu?".concat(i.toString()))).menuItems||[]).map(u)}catch(e){console.warn("Lambda API failed, falling back to direct DynamoDB:",e)}console.log("\uD83D\uDCE1 Using direct DynamoDB for menu fetching");let a=await i.DynamoDBService.getMenuItems(e);if(t&&(a=a.filter(e=>e.locationId===t)),r){let e=r.toLowerCase();a=a.filter(t=>{var r;return t.name.toLowerCase().includes(e)||(null==(r=t.description)?void 0:r.toLowerCase().includes(e))})}return a.map(u)}}},59214:(e,t,r)=>{r.r(t),r.d(t,{default:()=>V});var i=r(95155),n=r(12115),a=r(50625),o=r(1733),c=r(26497),s=r(20063),d=r(86651),l=r(89559),p=r(26983),u=r(20508),m=r(69141),f=r(26617),g=r(21873),h=r(46398),y=r(39347),b=r(57828),w=r(15824);let v=a.Ay.div.withConfig({componentId:"jt-app__sc-eccf88-0"})(["padding:1rem;min-height:100vh;background:linear-gradient(135deg,#fef7ee 0%,#fafaf9 100%);padding-bottom:120px;"]),x=a.Ay.div.withConfig({componentId:"jt-app__sc-eccf88-1"})(["margin-bottom:2rem;text-align:center;"]),j=a.Ay.h1.withConfig({componentId:"jt-app__sc-eccf88-2"})(["font-size:1.5rem;font-weight:700;color:#1f2937;margin:0 0 0.5rem 0;"]),A=a.Ay.p.withConfig({componentId:"jt-app__sc-eccf88-3"})(["font-size:1rem;color:#6b7280;margin:0;"]),_=a.Ay.div.withConfig({componentId:"jt-app__sc-eccf88-4"})(["display:grid;grid-template-columns:repeat(3,1fr);gap:0.75rem;margin-bottom:1.5rem;"]),C=a.Ay.div.withConfig({componentId:"jt-app__sc-eccf88-5"})(["background:white;border-radius:8px;padding:1rem 0.75rem;text-align:center;border:1px solid rgba(237,119,52,0.1);box-shadow:0 1px 3px rgba(0,0,0,0.05);"]),k=a.Ay.div.withConfig({componentId:"jt-app__sc-eccf88-6"})(["font-size:1.25rem;font-weight:700;color:#1f2937;"]),I=a.Ay.div.withConfig({componentId:"jt-app__sc-eccf88-7"})(["font-size:0.75rem;color:#6b7280;margin-top:0.25rem;"]),D=a.Ay.div.withConfig({componentId:"jt-app__sc-eccf88-8"})(["margin-bottom:1.5rem;"]),z=a.Ay.div.withConfig({componentId:"jt-app__sc-eccf88-9"})(["position:relative;margin-bottom:1rem;"]),L=a.Ay.input.withConfig({componentId:"jt-app__sc-eccf88-10"})(["width:100%;padding:0.75rem 1rem 0.75rem 2.5rem;border:1px solid #d1d5db;border-radius:8px;font-size:0.875rem;background:white;&:focus{outline:none;border-color:#ed7734;box-shadow:0 0 0 3px rgba(237,119,52,0.1);}"]),S=a.Ay.div.withConfig({componentId:"jt-app__sc-eccf88-11"})(["position:absolute;left:0.75rem;top:50%;transform:translateY(-50%);color:#6b7280;"]),O=(0,a.Ay)(o.P.button).withConfig({componentId:"jt-app__sc-eccf88-12"})(["width:100%;padding:0.75rem;background:#ed7734;color:white;border:none;border-radius:8px;font-size:0.875rem;font-weight:600;display:flex;align-items:center;justify-content:center;gap:0.5rem;cursor:pointer;"]),N=a.Ay.div.withConfig({componentId:"jt-app__sc-eccf88-13"})(["display:flex;gap:0.5rem;overflow-x:auto;padding-bottom:0.5rem;margin-bottom:1rem;&::-webkit-scrollbar{display:none;}"]),B=a.Ay.button.withConfig({componentId:"jt-app__sc-eccf88-14"})(["padding:0.5rem 0.75rem;border:1px solid ",";background:",";color:",";border-radius:6px;font-size:0.75rem;font-weight:500;cursor:pointer;white-space:nowrap;&:active{transform:scale(0.98);}"],e=>e.active?"#ed7734":"#d1d5db",e=>e.active?"#ed7734":"white",e=>e.active?"white":"#6b7280"),P=a.Ay.div.withConfig({componentId:"jt-app__sc-eccf88-15"})(["display:flex;flex-direction:column;gap:0.75rem;"]),T=(0,a.Ay)(o.P.div).withConfig({componentId:"jt-app__sc-eccf88-16"})(["background:white;border-radius:12px;padding:1rem;box-shadow:0 1px 3px rgba(0,0,0,0.1);border:1px solid rgba(237,119,52,0.1);"]),R=a.Ay.div.withConfig({componentId:"jt-app__sc-eccf88-17"})(["display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:0.75rem;"]),U=a.Ay.div.withConfig({componentId:"jt-app__sc-eccf88-18"})(["flex:1;"]),E=a.Ay.h3.withConfig({componentId:"jt-app__sc-eccf88-19"})(["font-size:1rem;font-weight:600;color:#1f2937;margin:0 0 0.25rem 0;"]),q=a.Ay.div.withConfig({componentId:"jt-app__sc-eccf88-20"})(["font-size:0.75rem;color:#6b7280;display:flex;align-items:center;gap:0.25rem;"]),M=a.Ay.div.withConfig({componentId:"jt-app__sc-eccf88-21"})(["font-size:0.75rem;font-weight:500;padding:0.25rem 0.5rem;border-radius:4px;text-transform:capitalize;background:",";color:",";"],e=>{switch(e.status){case"pending":return"rgba(251, 191, 36, 0.1)";case"confirmed":return"rgba(59, 130, 246, 0.1)";case"preparing":return"rgba(168, 85, 247, 0.1)";case"ready":return"rgba(16, 185, 129, 0.1)";case"out-for-delivery":return"rgba(245, 158, 11, 0.1)";case"delivered":return"rgba(34, 197, 94, 0.1)";case"cancelled":return"rgba(239, 68, 68, 0.1)";default:return"rgba(107, 114, 128, 0.1)"}},e=>{switch(e.status){case"pending":return"#d97706";case"confirmed":return"#2563eb";case"preparing":return"#7c3aed";case"ready":return"#059669";case"out-for-delivery":return"#f59e0b";case"delivered":return"#16a34a";case"cancelled":return"#dc2626";default:return"#4b5563"}}),Y=a.Ay.div.withConfig({componentId:"jt-app__sc-eccf88-22"})(["display:flex;flex-direction:column;gap:0.5rem;margin-bottom:0.75rem;"]),J=a.Ay.div.withConfig({componentId:"jt-app__sc-eccf88-23"})(["display:flex;align-items:center;gap:0.5rem;font-size:0.875rem;color:#6b7280;"]),F=a.Ay.div.withConfig({componentId:"jt-app__sc-eccf88-24"})(["display:flex;justify-content:space-between;align-items:center;padding-top:0.75rem;border-top:1px solid #f3f4f6;"]),H=a.Ay.span.withConfig({componentId:"jt-app__sc-eccf88-25"})(["font-size:1rem;font-weight:600;color:#ed7734;"]),K=a.Ay.button.withConfig({componentId:"jt-app__sc-eccf88-26"})(["padding:0.5rem 0.75rem;background:transparent;border:1px solid #ed7734;color:#ed7734;border-radius:6px;font-size:0.75rem;font-weight:500;cursor:pointer;&:active{transform:scale(0.98);background:rgba(237,119,52,0.05);}"]);function V(e){let{className:t,userRole:r="customer",userId:a}=e;(0,s.useRouter)();let[o,V]=(0,n.useState)([]),[Q,W]=(0,n.useState)(!0),[X,$]=(0,n.useState)(""),[Z,G]=(0,n.useState)("all"),ee=(0,n.useCallback)(async()=>{W(!0);try{let e=(await w.I.getAllOrders()).map(e=>{var t,r;return{id:e.id,customerId:(null==(t=e.location)?void 0:t.businessId)||"unknown",customerName:e.customerName,customerPhone:e.customerEmail,items:[e.orderDetails],total:0,status:e.status,createdAt:e.createdAt.toISOString(),estimatedTime:"delivered"===e.status?"Delivered":"picked_up"===e.status?"Out for Delivery":"Preparing",deliveryAddress:(null==(r=e.location)?void 0:r.businessId)||"Pickup",driverId:e.driverName?"DRV-001":void 0,driverName:e.driverName,rating:"delivered"===e.status?5:void 0}}),t=e;"customer"===r&&a?t=e.filter(e=>e.customerId===a):"driver"===r&&a&&(t=e.filter(e=>"pending"===e.status||e.driverId===a)),V(t),console.log("✅ Loaded ".concat(t.length," orders successfully"))}catch(t){console.error("Failed to load orders:",t);let e=t instanceof Error?t.message:"Unknown error";alert("⚠️ Could not load orders\n\n".concat(e,"\n\nNote: This app requires AWS DynamoDB. Check your configuration.")),V([])}finally{W(!1)}},[r,a]);(0,n.useEffect)(()=>{ee()},[ee]);let et=o.filter(e=>{let t=e.id.toLowerCase().includes(X.toLowerCase())||e.customerName.toLowerCase().includes(X.toLowerCase())||e.items.some(e=>e.toLowerCase().includes(X.toLowerCase())),r="all"===Z||e.status===Z;return t&&r}),er=(()=>{switch(r){case"driver":return[{key:"all",label:"All"},{key:"ready",label:"Ready"},{key:"out-for-delivery",label:"Delivering"},{key:"delivered",label:"Delivered"}];case"manager":return[{key:"all",label:"All"},{key:"pending",label:"Pending"},{key:"preparing",label:"Preparing"},{key:"ready",label:"Ready"}];default:return[{key:"all",label:"All"},{key:"preparing",label:"Preparing"},{key:"ready",label:"Ready"},{key:"delivered",label:"Delivered"}]}})(),ei=(()=>{let e=o.length;return{total:e,active:o.filter(e=>["pending","confirmed","preparing","ready","out-for-delivery"].includes(e.status)).length,completed:o.filter(e=>"delivered"===e.status).length}})();return Q?(0,i.jsx)(v,{className:t,children:(0,i.jsx)(x,{children:(0,i.jsx)(j,{children:"Loading Orders..."})})}):(0,i.jsxs)(v,{className:t,children:[(0,i.jsxs)(x,{children:[(0,i.jsx)(j,{children:(()=>{switch(r){case"driver":return"Driver Orders";case"manager":return"Restaurant Orders";case"admin":return"All Orders";default:return"My Orders"}})()}),(0,i.jsx)(A,{children:(()=>{switch(r){case"driver":return"Orders available for delivery";case"manager":return"Manage restaurant orders";case"admin":return"System-wide order management";default:return"Your order history and tracking"}})()})]}),(0,i.jsxs)(_,{children:[(0,i.jsxs)(C,{children:[(0,i.jsx)(k,{children:ei.total}),(0,i.jsx)(I,{children:"Total"})]}),(0,i.jsxs)(C,{children:[(0,i.jsx)(k,{children:ei.active}),(0,i.jsx)(I,{children:"Active"})]}),(0,i.jsxs)(C,{children:[(0,i.jsx)(k,{children:ei.completed}),(0,i.jsx)(I,{children:"Completed"})]})]}),(0,i.jsxs)(D,{children:[(0,i.jsxs)(z,{children:[(0,i.jsx)(S,{children:(0,i.jsx)(d.A,{size:16})}),(0,i.jsx)(L,{type:"text",placeholder:"Search orders...",value:X,onChange:e=>$(e.target.value)})]}),(0,i.jsx)(N,{children:er.map(e=>(0,i.jsx)(B,{active:Z===e.key,onClick:()=>G(e.key),children:e.label},e.key))}),(0,i.jsxs)(O,{whileTap:{scale:.98},onClick:ee,disabled:Q,children:[(0,i.jsx)(l.A,{size:16}),Q?"Loading...":"Refresh Orders"]})]}),(0,i.jsx)(P,{children:(0,i.jsx)(c.N,{children:et.map((e,t)=>(0,i.jsxs)(T,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{delay:.05*t},children:[(0,i.jsxs)(R,{children:[(0,i.jsxs)(U,{children:[(0,i.jsx)(E,{children:e.id}),(0,i.jsxs)(q,{children:[(0,i.jsx)(p.A,{size:12}),(e=>{let t=new Date(e),r=Math.floor((new Date().getTime()-t.getTime())/6e4);if(r<60)return"".concat(r,"m ago");{let e=Math.floor(r/60);return"".concat(e,"h ago")}})(e.createdAt)]})]}),(0,i.jsx)(M,{status:e.status,children:e.status})]}),(0,i.jsxs)(Y,{children:["customer"!==r&&(0,i.jsxs)(J,{children:[(0,i.jsx)(u.A,{size:14}),e.customerName,(0,i.jsx)(m.A,{size:12,style:{marginLeft:"auto"}})]}),(0,i.jsxs)(J,{children:[(0,i.jsx)(f.A,{size:14}),e.items.slice(0,2).join(", "),e.items.length>2&&" +".concat(e.items.length-2," more")]}),(0,i.jsxs)(J,{children:[(0,i.jsx)(g.A,{size:14}),e.deliveryAddress]}),e.driverName&&(0,i.jsxs)(J,{children:[(0,i.jsx)(h.A,{size:14}),"Driver: ",e.driverName]}),(0,i.jsxs)(J,{children:[(0,i.jsx)(p.A,{size:14}),e.estimatedTime]}),e.rating&&(0,i.jsxs)(J,{children:[(0,i.jsx)(y.A,{size:14}),"Rating: ",e.rating,"/5"]})]}),(0,i.jsxs)(F,{children:[(0,i.jsxs)(H,{children:["$",e.total.toFixed(2)]}),(0,i.jsxs)(K,{onClick:()=>alert("View order ".concat(e.id)),children:[(0,i.jsx)(b.A,{size:12,style:{marginRight:"0.25rem"}}),"View Details"]})]})]},e.id))})}),0===et.length&&(0,i.jsx)("div",{style:{textAlign:"center",marginTop:"2rem",color:"#6b7280"},children:"No orders found matching your criteria."})]})}}}]);